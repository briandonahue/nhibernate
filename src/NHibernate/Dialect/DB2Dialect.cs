using System;
using System.Data;

namespace NHibernate.Dialect
{
	/// <summary>
	/// An SQL dialect for DB2.
	/// </summary>
	public class DB2Dialect : Dialect
	{
		public DB2Dialect() : base() {
			/* Type mapping in Java was:
			
			Types.BIT, "SMALLINT"
			Types.BIGINT, "BIGINT"
			Types.SMALLINT, "SMALLINT"
			Types.TINYINT, "SMALLINT"
			Types.INTEGER, "INTEGER"
			Types.CHAR, "CHAR(1)"
			Types.VARCHAR, "VARCHAR($l)"
			Types.FLOAT, "FLOAT"
			Types.DOUBLE, "DOUBLE"
			Types.DATE, "DATE"
			Types.TIME, "TIME"
			Types.TIMESTAMP, "TIMESTAMP"
			Types.VARBINARY, "VARCHAR($l) FOR BIT DATA"
			Types.NUMERIC, "NUMERIC(19, $l)"
			Types.BLOB, "BLOB($l)"
			Types.CLOB, "CLOB($l)"
			*/			

			Register( SqlDbType.Bit, "SMALLINT" );
			Register( SqlDbType.BigInt, "BIGINT" );
			Register( SqlDbType.SmallInt, "SMALLINT" );
			Register( SqlDbType.TinyInt, "SMALLINT" );
			Register( SqlDbType.Int, "INTEGER" );
			Register( SqlDbType.Char, "CHAR(1)" );
			Register( SqlDbType.VarChar, "VARCHAR($l)" );
			Register( SqlDbType.Float, "FLOAT" );
			Register( SqlDbType.Real, "DOUBLE" );
			Register( SqlDbType.DateTime, "DATE" );
			// register( Types.TIME, "TIME" );  ???
			Register( SqlDbType.Timestamp, "TIMESTAMP" );
			Register( SqlDbType.VarBinary, "VARCHAR($l) FOR BIT DATA" );
			Register( SqlDbType.Decimal, "NUMERIC(19, $l)" );
			Register( SqlDbType.Image, "BLOB($l)" );
			Register( SqlDbType.Text, "CLOB($l)" );
		
			/*
			getDefaultProperties().setProperty(Environment.OUTER_JOIN, "true");
			getDefaultProperties().setProperty(Environment.STATEMENT_BATCH_SIZE, NO_BATCH);
			*/
		}
		
		public string GetAddColumnString() {
			return "add column";
		}
		public bool DropConstraints() {
			return false;
		}
		public bool SupportsIdentityColumns() {
			return true;
		}
		public string GetIdentitySelectString() {
			return "values IDENTITY_VAL_LOCAL()";
		}
		public string GetIdentityColumnString() {
			return "not null generated by default as identity";
		}
		public string GetIdentityInsertString() {
			return "default";
		}
		
		public string GetSequenceNextValString(string sequenceName) {
			return "values nextval for " + sequenceName;
		}
		public string GetCreateSequenceString(string sequenceName) {
			return "create sequence " + sequenceName;
		}
		public string GetDropSequenceString(string sequenceName) {
			return "drop sequence " + sequenceName + " restrict";
		}
		
		public bool SupportsSequences() {
			return true;
		}
	}
}